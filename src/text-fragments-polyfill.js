// Only load the polyfill in browsers that need it.
if (!('fragmentDirective' in Location.prototype) && !('fragmentDirective' in document)) {

// https://github.com/GoogleChromeLabs/text-fragments-polyfill
//
// This polyfill is used to navigate to #:~:text= fragments in browsers that do not yet natively support them:
// https://caniuse.com/url-scroll-to-text-fragment
//
// Below is a copy of https://unpkg.com/text-fragments-polyfill@5.4.1/dist/text-fragments.js
// with a copyright header from https://github.com/GoogleChromeLabs/text-fragments-polyfill/blob/main/src/text-fragments.js

/**
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

const e=["text"],t=["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","BR","DETAILS","DIALOG","DD","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","LI","MAIN","NAV","OL","P","PRE","SECTION","TABLE","UL","TR","TH","TD","COLGROUP","COL","CAPTION","THEAD","TBODY","TFOOT"],n=/[\t-\r -#%-\*,-\/:;\?@\[-\]_\{\}\x85\xA0\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E44\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC9\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3E]|\uD807[\uDC41-\uDC45\uDC70\uDC71]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/u,u=e=>{const t=/^(?:(.+?)-,)?(?:(.+?))(?:,([^-]+?))?(?:,-(.+?))?$/;return{prefix:decodeURIComponent(e.replace(t,"$1")),textStart:decodeURIComponent(e.replace(t,"$2")),textEnd:decodeURIComponent(e.replace(t,"$3")),suffix:decodeURIComponent(e.replace(t,"$4"))}},r=(e,t=document)=>{const n=[],u=t.createRange();for(u.selectNodeContents(t.body);!u.collapsed&&n.length<2;){let r;if(e.prefix){const n=f(e.prefix,u);if(null==n)break;a(u,n.startContainer,n.startOffset);const o=t.createRange();if(o.setStart(n.endContainer,n.endOffset),o.setEnd(u.endContainer,u.endOffset),i(o),o.collapsed)break;if(r=f(e.textStart,o),null==r)break;if(0!==r.compareBoundaryPoints(Range.START_TO_START,o))continue}else{if(r=f(e.textStart,u),null==r)break;a(u,r.startContainer,r.startOffset)}if(e.textEnd){const i=t.createRange();i.setStart(r.endContainer,r.endOffset),i.setEnd(u.endContainer,u.endOffset);let l=!1;for(;!i.collapsed&&n.length<2;){const F=f(e.textEnd,i);if(null==F)break;if(a(i,F.startContainer,F.startOffset),r.setEnd(F.endContainer,F.endOffset),e.suffix){const a=s(e.suffix,r,u,t);if(a===o.NO_SUFFIX_MATCH)break;if(a===o.SUFFIX_MATCH){l=!0,n.push(r.cloneRange());continue}if(a===o.MISPLACED_SUFFIX)continue}else l=!0,n.push(r.cloneRange())}if(!l)break}else if(e.suffix){const i=s(e.suffix,r,u,t);if(i===o.NO_SUFFIX_MATCH)break;if(i===o.SUFFIX_MATCH){n.push(r.cloneRange()),a(u,u.startContainer,u.startOffset);continue}if(i===o.MISPLACED_SUFFIX)continue}else n.push(r.cloneRange())}return n},o={NO_SUFFIX_MATCH:0,SUFFIX_MATCH:1,MISPLACED_SUFFIX:2},s=(e,t,n,u)=>{const r=u.createRange();r.setStart(t.endContainer,t.endOffset),r.setEnd(n.endContainer,n.endOffset),i(r);const s=f(e,r);return null==s?o.NO_SUFFIX_MATCH:0!==s.compareBoundaryPoints(Range.START_TO_START,r)?o.MISPLACED_SUFFIX:o.SUFFIX_MATCH},a=(e,t,n)=>{try{e.setStart(t,n+1)}catch(n){e.setStartAfter(t)}},i=e=>{const t=l(e);let n=t.nextNode();for(;!e.collapsed&&null!=n;){if(n!==e.startContainer&&e.setStart(n,0),n.textContent.length>e.startOffset){if(!n.textContent[e.startOffset].match(/\s/))return}try{e.setStart(n,e.startOffset+1)}catch(u){n=t.nextNode(),null==n?e.collapse():e.setStart(n,0)}}},l=e=>document.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,(t=>D(t,e))),F=(e,n=document)=>{if(e.startContainer.nodeType!=Node.TEXT_NODE||e.endContainer.nodeType!=Node.TEXT_NODE)return[];if(e.startContainer===e.endContainer){const t=n.createElement("mark");return t.setAttribute("class","text-fragments-polyfill-target-text"),e.surroundContents(t),[t]}const u=e.startContainer,r=e.cloneRange();r.setEndAfter(u);const o=e.endContainer,s=e.cloneRange();s.setStartBefore(o);const a=[];e.setStartAfter(u),e.setEndBefore(o);const i=n.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,{acceptNode:function(n){return e.intersectsNode(n)?t.includes(n.tagName)||n.nodeType===Node.TEXT_NODE?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_REJECT}});let l=i.nextNode();for(;l;){if(l.nodeType===Node.TEXT_NODE){const e=n.createElement("mark");e.setAttribute("class","text-fragments-polyfill-target-text"),l.parentNode.insertBefore(e,l),e.appendChild(l),a.push(e)}l=i.nextNode()}const F=n.createElement("mark");F.setAttribute("class","text-fragments-polyfill-target-text"),r.surroundContents(F);const c=n.createElement("mark");return c.setAttribute("class","text-fragments-polyfill-target-text"),s.surroundContents(c),[F,...a,c]},c=e=>{let t=e;for(;null!=t&&!(t instanceof HTMLElement);)t=t.parentNode;if(null!=t){const e=window.getComputedStyle(t);if("hidden"===e.visibility||"none"===e.display||0===e.height||0===e.width||0===e.opacity)return!1}return!0},D=(e,t)=>(null==t||t.intersectsNode(e))&&c(e)?e.nodeType===Node.TEXT_NODE?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_REJECT,d=(e,n)=>{const u=[];let r=[];const o=Array.from(function*(e,t){const n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,{acceptNode:t}),u=new Set;for(;null!==m(n,u);)yield n.currentNode}(e,(e=>((e,t)=>(null==t||t.intersectsNode(e))&&c(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT)(e,n))));for(const e of o)e.nodeType===Node.TEXT_NODE?r.push(e):e instanceof HTMLElement&&t.includes(e.tagName)&&r.length>0&&(u.push(r),r=[]);return r.length>0&&u.push(r),u};const f=(e,t)=>{const n=d(t.commonAncestorContainer,t),u=T();for(const r of n){const n=E(e,t,r,u);if(void 0!==n)return n}},E=(e,t,n,u)=>{if(!e||!t||!(n||[]).length)return;const r=g(((e,t,n)=>{let u="";return u=1===e.length?e[0].textContent.substring(t,n):e[0].textContent.substring(t)+e.slice(1,-1).reduce(((e,t)=>e+t.textContent),"")+e.slice(-1)[0].textContent.substring(0,n),u.replace(/[\t\n\r ]+/g," ")})(n,0,void 0)),o=g(e);let s,a,i=n[0]===t.startNode?t.startOffset:0;for(;i<r.length;){const e=r.indexOf(o,i);if(-1===e)return;if(A(r,e,o.length,u)&&(s=C(e,n,!1),a=C(e+o.length,n,!0)),null!=s&&null!=a){const e=new Range;if(e.setStart(s.node,s.offset),e.setEnd(a.node,a.offset),t.compareBoundaryPoints(Range.START_TO_START,e)<=0&&t.compareBoundaryPoints(Range.END_TO_END,e)>=0)return e}i=e+1}},C=(e,t,n)=>{let u,r=0;for(let o=0;o<t.length;o++){const s=t[o];u||(u=g(s.data));let a=r+u.length;if(n&&(a+=1),a>e){const t=e-r;let o=Math.min(e-r,s.data.length);const a=n?u.substring(0,t):u.substring(t);let i=g(n?s.data.substring(0,o):s.data.substring(o));const l=(n?-1:1)*(a.length>i.length?-1:1);for(;o>=0&&o<=s.data.length;){if(i.length===a.length)return{node:s,offset:o};o+=l,i=g(n?s.data.substring(0,o):s.data.substring(o))}}if(r+=u.length,o+1<t.length){const e=g(t[o+1].data);" "===u.slice(-1)&&" "===e.slice(0,1)&&(r-=1),u=e}}},A=(e,t,u,r)=>{if(t<0||t>=e.length||u<=0||t+u>e.length)return!1;if(r){const n=r.segment(e),o=n.containing(t);if(!o)return!1;if(o.isWordLike&&o.index!=t)return!1;const s=t+u,a=n.containing(s);if(a&&a.isWordLike&&a.index!=s)return!1}else{if(e[t].match(n)&&(++t,!--u))return!1;if(e[t+u-1].match(n)&&!--u)return!1;if(0!==t&&!e[t-1].match(n))return!1;if(t+u!==e.length&&!e[t+u].match(n))return!1}return!0},g=e=>(e||"").normalize("NFKD").replace(/\s+/g," ").replace(/[\u0300-\u036f]/g,"").toLowerCase(),T=()=>{if(Intl.Segmenter){let e=document.documentElement.lang;return e||(e=navigator.languages),new Intl.Segmenter(e,{granularity:"word"})}},m=(e,t)=>{if(!t.has(e.currentNode)){const t=e.firstChild();if(null!==t)return t}const n=e.nextSibling();if(null!==n)return n;const u=e.parentNode();return null!==u&&t.add(u),u};"undefined"!=typeof goog&&goog.declareModuleId("googleChromeLabs.textFragmentPolyfill.textFragmentUtils");(async()=>{if("fragmentDirective"in document||"fragmentDirective"in Location.prototype)return;const t=document.location.hash;if(document.fragmentDirective={},!t)return;const n=()=>{const n=(e=>{const t=e.replace(/#.*?:~:(.*?)/,"$1").split(/&?text=/).filter(Boolean);return t.length?{text:t}:{}})(t),o=(t=>{const n={};for(const[r,o]of Object.entries(t))e.includes(r)&&(n[r]=o.map((e=>u(e))));return n})(n),s=((t,n=document)=>{const u={};for(const[o,s]of Object.entries(t))e.includes(o)&&(u[o]=s.map((e=>{const t=r(e,n);return t.length>=1?F(t[0],n):[]})));return u})(o),a=s.text;(()=>{const e=document.getElementsByTagName("style");if(e)for(const t of e){const e=t.innerHTML.match(/(\w*)::target-text\s*{\s*((.|\n)*?)\s*}/g);if(!e)continue;const n=e.join("\n"),u=document.createTextNode(n.replaceAll("::target-text"," .text-fragments-polyfill-target-text"));t.appendChild(u)}})();const i=a.find((e=>e.length))[0];i&&window.setTimeout((()=>{i.scrollIntoView({behavior:"auto",block:"center",inline:"nearest"})}))};"complete"!==document.readyState?document.addEventListener("readystatechange",(e=>{"complete"===e.target.readyState&&n()})):n()})();

// end of dist/text-fragments.js

}
